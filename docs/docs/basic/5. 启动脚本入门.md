---
title: å¯åŠ¨è„šæœ¬å…¥é—¨
icon: mdi:script
createTime: 2026/02/05 00:17:50
permalink: /docs/basic/startup/
foo: foo
tags:
    - Java
    - å†…å­˜
    - è„šæœ¬
---
MinecraftæœåŠ¡å™¨ä¸èƒ½åƒ~~åŸç¥~~é‚£æ ·åŒå‡»exeå¯åŠ¨ï¼Œå®ƒè·ŸJavaç‰ˆMinecraftä¸€æ ·ï¼Œéœ€è¦ä¾é ä¸€ä¸ªâ€œ::material-symbols:terminal::å¯åŠ¨å™¨â€æ¥å¯åŠ¨ã€‚è¿™ä¸ªâ€œå¯åŠ¨å™¨â€å°±æ˜¯â€œ::mdi:script::å¯åŠ¨è„šæœ¬â€ã€‚

è¿™é‡Œå±•ç¤ºäº†ä¸€ä¸ª==ç¤ºä¾‹==çš„MinecraftæœåŠ¡å™¨å¯åŠ¨è„šæœ¬ï¼Œä»¥ä¾›å¤§å®¶==å€Ÿé‰´å­¦ä¹ ==ï¼š

```shell title="start.sh"
#!/bin/bash

# ========================================
# Minecraft æœåŠ¡å™¨å¯åŠ¨è„šæœ¬
# ========================================

# é…ç½®åŒºåŸŸ
SERVER_JAR="server.jar"           # æœåŠ¡å™¨jaræ–‡ä»¶å
MIN_RAM="2G"                       # æœ€å°å†…å­˜åˆ†é…
MAX_RAM="4G"                       # æœ€å¤§å†…å­˜åˆ†é…
JAVA_ARGS="-XX:+UseG1GC -XX:+ParallelRefProcEnabled -XX:MaxGCPauseMillis=200 -XX:+UnlockExperimentalVMOptions -XX:+DisableExplicitGC -XX:+AlwaysPreTouch -XX:G1NewSizePercent=30 -XX:G1MaxNewSizePercent=40 -XX:G1HeapRegionSize=8M -XX:G1ReservePercent=20 -XX:G1HeapWastePercent=5 -XX:G1MixedGCCountTarget=4 -XX:InitiatingHeapOccupancyPercent=15 -XX:G1MixedGCLiveThresholdPercent=90 -XX:G1RSetUpdatingPauseTimePercent=5 -XX:SurvivorRatio=32 -XX:+PerfDisableSharedMem -XX:MaxTenuringThreshold=1"

# é¢œè‰²è¾“å‡º
GREEN='\033[0;32m'
YELLOW='\033[1;33m'
RED='\033[0;31m'
NC='\033[0m' # No Color

# æ£€æŸ¥Javaæ˜¯å¦å®‰è£…
check_java() {
    if ! command -v java &> /dev/null; then
        echo -e "${RED}é”™è¯¯: æœªæ‰¾åˆ°Javaï¼Œè¯·å…ˆå®‰è£…Javaï¼${NC}"
        exit 1
    fi
    
    echo -e "${GREEN}Javaç‰ˆæœ¬:${NC}"
    java -version
    echo ""
}

# æ£€æŸ¥æœåŠ¡å™¨jaræ–‡ä»¶
check_server_jar() {
    if [ ! -f "$SERVER_JAR" ]; then
        echo -e "${RED}é”™è¯¯: æœªæ‰¾åˆ°æœåŠ¡å™¨æ–‡ä»¶ $SERVER_JAR${NC}"
        echo -e "${YELLOW}è¯·å°†æœåŠ¡å™¨jaræ–‡ä»¶é‡å‘½åä¸º $SERVER_JAR æˆ–ä¿®æ”¹è„šæœ¬ä¸­çš„ SERVER_JAR å˜é‡${NC}"
        exit 1
    fi
}

# åŒæ„EULA
accept_eula() {
    if [ ! -f "eula.txt" ]; then
        echo -e "${YELLOW}é¦–æ¬¡è¿è¡Œéœ€è¦åŒæ„EULA...${NC}"
        echo "eula=true" > eula.txt
        echo -e "${GREEN}å·²è‡ªåŠ¨åŒæ„EULA${NC}"
    fi
}

# åˆ›å»ºå¯åŠ¨æ—¥å¿—ç›®å½•
create_log_dir() {
    if [ ! -d "logs" ]; then
        mkdir logs
    fi
}

# ä¸»å¯åŠ¨å‡½æ•°
start_server() {
    echo -e "${GREEN}========================================${NC}"
    echo -e "${GREEN}æ­£åœ¨å¯åŠ¨MinecraftæœåŠ¡å™¨...${NC}"
    echo -e "${GREEN}æœ€å°å†…å­˜: $MIN_RAM${NC}"
    echo -e "${GREEN}æœ€å¤§å†…å­˜: $MAX_RAM${NC}"
    echo -e "${GREEN}========================================${NC}"
    echo ""
    
    # å¯åŠ¨æœåŠ¡å™¨
    java -Xms$MIN_RAM -Xmx$MAX_RAM $JAVA_ARGS -jar $SERVER_JAR nogui
    
    # æœåŠ¡å™¨å…³é—­åçš„å¤„ç†
    EXIT_CODE=$?
    echo ""
    echo -e "${YELLOW}æœåŠ¡å™¨å·²å…³é—­ (é€€å‡ºä»£ç : $EXIT_CODE)${NC}"
    
    return $EXIT_CODE
}

# è‡ªåŠ¨é‡å¯å¾ªç¯
auto_restart() {
    while true; do
        start_server
        
        echo -e "${YELLOW}æœåŠ¡å™¨å°†åœ¨10ç§’åé‡å¯...${NC}"
        echo -e "${YELLOW}æŒ‰ Ctrl+C å–æ¶ˆé‡å¯${NC}"
        
        sleep 10
    done
}

# ä¸»ç¨‹åº
main() {
    clear
    echo -e "${GREEN}========================================${NC}"
    echo -e "${GREEN}   Minecraft æœåŠ¡å™¨å¯åŠ¨è„šæœ¬${NC}"
    echo -e "${GREEN}========================================${NC}"
    echo ""
    
    # æ‰§è¡Œæ£€æŸ¥
    check_java
    check_server_jar
    accept_eula
    create_log_dir
    
    # è¯¢é—®æ˜¯å¦å¯ç”¨è‡ªåŠ¨é‡å¯
    echo -e "${YELLOW}æ˜¯å¦å¯ç”¨è‡ªåŠ¨é‡å¯åŠŸèƒ½? (y/n)${NC}"
    read -r response
    
    if [[ "$response" =~ ^[Yy]$ ]]; then
        echo -e "${GREEN}è‡ªåŠ¨é‡å¯å·²å¯ç”¨${NC}"
        echo ""
        auto_restart
    else
        echo -e "${GREEN}å•æ¬¡è¿è¡Œæ¨¡å¼${NC}"
        echo ""
        start_server
    fi
}

# è¿è¡Œä¸»ç¨‹åº
main
```

è¿™é‡Œåšä¸ªç®€å•çš„æŠ½è±¡è§£é‡Šæ¥è¯´æ˜ä¸Šè¿°å¯åŠ¨è„šæœ¬çš„åŠŸèƒ½:

::: steps

1. **é¦–å…ˆï¼Œè„šæœ¬åœ¨å¯åŠ¨æœåŠ¡å™¨å‰ä¼šè‡ªåŠ¨æ‰§è¡Œä¸€ç³»åˆ—â€œä½“æ£€â€ï¼Œç¡®ä¿ä¸ä¼šå› ä¸ºä½çº§é”™è¯¯å¯¼è‡´å¯åŠ¨å¤±è´¥**

    1. æ£€æŸ¥ç³»ç»Ÿæ˜¯å¦å®‰è£…äº† Java ç¯å¢ƒï¼Œå¹¶æ˜¾ç¤ºå½“å‰ç‰ˆæœ¬ã€‚

    2. ç¡®è®¤ server.jar æ˜¯å¦å­˜åœ¨ï¼Œé¿å…è„šæœ¬ç©ºè½¬ã€‚

    3. è‡ªåŠ¨åˆ›å»ºå¹¶è®¾ç½® eula.txt ä¸º trueï¼Œçœå»äº†æ‰‹åŠ¨ç¼–è¾‘çš„éº»çƒ¦ã€‚

    4. è‡ªåŠ¨åˆ›å»º logs æ–‡ä»¶å¤¹ï¼Œç¡®ä¿æ—¥å¿—è®°å½•æœ‰å¤„å¯å¯»ã€‚

2. **è„šæœ¬ä¸­å®šä¹‰çš„ `JAVA_ARGS` è¿˜é‡‡ç”¨äº† Aikar's Flags å‚æ•°**

    ä¾‹å¦‚ Aikar's Flags å‚æ•°ä¸­å°±æœ‰ `G1GC` åƒåœ¾å›æ”¶å™¨å’Œ `-XX:+AlwaysPreTouch` åœ¨å¯åŠ¨æ—¶å°±å‘ç³»ç»Ÿç”³è¯·å¥½å…¨éƒ¨å†…å­˜ç­‰ä¼˜åŒ–å‚æ•°

3. **è¿™ä¸ªè„šæœ¬æä¾›äº†ä¸¤ç§è¿è¡Œé€»è¾‘**

    ä¸€ç§æ˜¯å•æ¬¡è¿è¡Œæ¨¡å¼ï¼Œé€‚åˆè°ƒè¯•æˆ–çŸ­æœŸå¼€å¯ï¼ŒæœåŠ¡å™¨å…³é—­åè„šæœ¬å³åœæ­¢

    å¦ä¸€ç§å°±æ˜¯è‡ªåŠ¨é‡å¯å¾ªç¯ï¼ˆAuto-Restartï¼‰ï¼Œå½“æœåŠ¡å™¨æ„å¤–å´©æºƒæˆ–æ­£å¸¸å…³é—­æ—¶ï¼Œè„šæœ¬ä¼šè¿›å…¥ 10 ç§’å€’è®¡æ—¶å¹¶è‡ªåŠ¨é‡æ–°æ‹‰èµ·æœåŠ¡ï¼Œä¿è¯å…¨å¤©å€™åœ¨çº¿

:::

æƒ³çŸ¥é“è¿™æ˜¯å¦‚ä½•åˆ¶ä½œçš„ï¼Ÿé‚£ä¹ˆä½ å°±å¯ä»¥å¼€å§‹ä»¥ä¸‹çš„å­¦ä¹ å•¦ï¼š

## ä»€ä¹ˆæ˜¯å¯åŠ¨è„šæœ¬ï¼Ÿ

å¯åŠ¨è„šæœ¬å°±æ˜¯ä¸€ä¸ª**æ–‡æœ¬æ–‡ä»¶**ï¼Œ==åŒ…å«äº†å¯åŠ¨MinecraftæœåŠ¡å™¨æ‰€éœ€çš„å…¨éƒ¨å‘½ä»¤==ã€‚ä½ å¯ä»¥æŠŠå®ƒç†è§£ä¸ºä¸€ä»½â€œæ“ä½œè¯´æ˜ä¹¦â€ï¼Œå‘Šè¯‰è®¡ç®—æœºå¦‚ä½•æ­£ç¡®åœ°è¿è¡ŒæœåŠ¡å™¨ã€‚

### è„šæœ¬çš„æœ¬è´¨

å¯åŠ¨è„šæœ¬å®é™…ä¸Šå°±æ˜¯==ä¸€è¡Œæˆ–å¤šè¡Œ**å‘½ä»¤**çš„é›†åˆ==ï¼Œè¿™äº›å‘½ä»¤ä¼šï¼š
- è°ƒç”¨Javaè¿è¡Œç¯å¢ƒï¼ˆJRE/JDKï¼‰
- åˆ†é…æœåŠ¡å™¨è¿è¡Œæ‰€éœ€çš„å†…å­˜
- æŒ‡å®šæœåŠ¡å™¨æ ¸å¿ƒæ–‡ä»¶ï¼ˆé€šå¸¸æ˜¯.jaræ–‡ä»¶ï¼‰
- è®¾ç½®å„ç§ä¼˜åŒ–å‚æ•°

## ä¸ºä»€ä¹ˆéœ€è¦å¯åŠ¨è„šæœ¬

ä½ å¯èƒ½ä¼šé—®ï¼šâ€œæˆ‘ç›´æ¥åŒå‡»æœåŠ¡å™¨jaræ–‡ä»¶ä¸è¡Œå—ï¼Ÿâ€<br>é‚£ä½ å°±åˆ«æƒ³äº†ï¼Œä½ è¦æ˜¯çœŸè¿™ä¹ˆå¹²ï¼Œå¯åŠ¨éƒ½ä¸ç»™ä½ å¯åŠ¨çš„ï¼Œä½ è®¡ç®—æ˜¯åŒå‡»100éä¹Ÿä¸€ç‚¹ååº”éƒ½æ²¡æœ‰ã€‚

ä½ å¯èƒ½åˆä¼šé—®ï¼šâ€œé‚£æˆ‘ç›´æ¥ç”¨`java`å‘½ä»¤è¡Œç›´æ¥åœ¨æœ¬åœ°å¯åŠ¨æœåŠ¡å™¨ä¸è¡Œå—ï¼Ÿâ€

!!ä½ è¦æ˜¯è¿™ä¹ˆå¹²äº†é‚£è¿™æ–‡æ¡£è¿˜æ€ä¹ˆå†™ä¸‹å»!!å½“ç„¶æ˜¯å¯ä»¥çš„ï¼Œä½†**éå¸¸ä¸æ¨è**ï¼Œå› ä¸ºï¼š

### 1. é‚£ä½ æ€ä¹ˆåˆ†é…å†…å­˜ï¼Ÿ

å¦‚æœä½ åªç”¨äº†javaå‘½ä»¤è¡Œè€Œæ²¡åšä»»ä½•æ›´æ”¹ï¼Œé‚£ä¹ˆJavaå¤§æ‰‹å­å°±ä¼š~~å¼€å§‹å‘åŠ›~~ï¼Œç›´æ¥ç»™ä½ ä½¿ç”¨é»˜è®¤çš„å†…å­˜è®¾ç½®ï¼ˆé€šå¸¸åªæœ‰å‡ ç™¾MBï¼‰ï¼Œè¿™å¯¹äºä¸€ä¸ªMinecraftæœåŠ¡å™¨æ¥è¯´æ ¹æœ¬ä¸å¤Ÿç”¨ï¼Œå®ƒä¼šå¯¼è‡´ï¼š
- æœåŠ¡å™¨é¢‘ç¹å¡å¡å¡å¡å¡å¡é¡¿
- åŒºå—åŠ è½½ç¼“æ…¢æ…¢æ…¢æ…¢æ…¢æ…¢æ…¢
- ç©å®¶è¿æ¥ä¸ç¨³ç¨³ç¨³ç¨³ç¨³ç¨³å®š
- æœåŠ¡å™¨å´©å´©å´©å´©å´©å´©å´©å´©æºƒ

è¿™ä½ è®©æˆ‘æ€ä¹ˆç©ï¼Ÿ

### 2. é‚£ä½ æ€ä¹ˆåšä¼˜åŒ–ï¼Ÿ
å¦‚æœä½ ä½¿ç”¨çš„æ˜¯::mdi:script::å¯åŠ¨è„šæœ¬ï¼Œé‚£ä½ å°±å¯ä»¥ç›´æ¥ç”¨==å„ç§JVMå‚æ•°==æ¥==ä¼˜åŒ–æœåŠ¡å™¨æ€§èƒ½==ã€‚

ä¸æ˜ç™½ä»€ä¹ˆæ„æ€ï¼Ÿä¾‹å¦‚ä¸‹é¢å†…å®¹åˆ—ä¸¾äº†ä¸€äº›å¯åŠ¨è„šæœ¬ä¸­å¯ä»¥å¡å…¥çš„ä¼˜åŒ–å‚æ•°ï¼š

- `-XX:+AlwaysPreTouch`ï¼šè®©æœåŠ¡å™¨åœ¨å¯åŠ¨æ—¶å°±ç›´æ¥â€œå æ»¡â€åˆ†é…çš„ç‰©ç†å†…å­˜ï¼Œè¿™æ ·å°±å¯ä»¥é¿å…æ¸¸æˆè¿‡ç¨‹ä¸­å› å‘ç³»ç»Ÿç”³è¯·å†…å­˜é¡µè€Œäº§ç”Ÿçš„å»¶è¿Ÿ
- `-XX:+UseG1GC`ï¼šç»å…¸çš„ G1 åƒåœ¾å›æ”¶å™¨ï¼Œæœ€é€‚åˆå¤„ç†åƒ Minecraft è¿™æ ·äº§ç”Ÿå¤§é‡çŸ­å‘½å¯¹è±¡ï¼ˆå¦‚æ–¹å—ä½ç½®ä¿¡æ¯ï¼‰çš„åº”ç”¨
- `-XX:MaxGCPauseMillis=200`ï¼šç›®æ ‡æ˜¯å°†æ¸…ç†åƒåœ¾å¯¼è‡´çš„åœé¡¿æ§åˆ¶åœ¨ 200ms ä»¥å†…ï¼ˆè¶Šä½è¶Šä¸å¡ï¼‰
- `-XX:G1HeapRegionSize`ï¼š
    - å†…å­˜ < 8Gï¼šè®¾ä¸º 8M
    - å†…å­˜ > 8Gï¼šè®¾ä¸º 16M æˆ– 32M

å°±è¿™äº›å‚æ•°è€Œè¨€ï¼Œå·²ç»è¶³ä»¥å¤Ÿçˆ†æ€ä¸€ä¸ªç®€å•çš„`java`å¯åŠ¨å‚æ•°å‡ ç™¾æ¬¡äº†ã€‚

### 3. é‚£ä½ æ€ä¹ˆæè‡ªåŠ¨åŒ–ï¼Ÿ
å¯åŠ¨è„šæœ¬æ˜¯å¯ä»¥é…ç½®ä¸€äº›è‡ªåŠ¨åŒ–çš„åŠŸèƒ½çš„ï¼Œæ¯”å¦‚ï¼š

::: steps

1. **æœåŠ¡å™¨å´©æºƒåè‡ªåŠ¨é‡å¯**ï¼šç›´æ¥é€šè¿‡`while`å‚æ•°å®ç°ï¼Œè¿™é‡Œåšä¸ªç¤ºèŒƒ

    ```bash
    while true; do
        echo "æœåŠ¡å™¨å¯åŠ¨ä¸­..."
        java -Xms8G -Xmx8G -jar server.jar nogui
        echo "æœåŠ¡å™¨å·²åœæ­¢ï¼Œ5ç§’åè‡ªåŠ¨é‡å¯ã€‚æŒ‰ Ctrl+C é€€å‡ºå¾ªç¯ã€‚"
        sleep 5
    done
    ```

2. **æ§åˆ¶å°æ—¥å¿—è®°å½•**ï¼šå¯ä»¥é€šè¿‡`tee`å‚æ•°å®ç°ï¼Œä¾æ—§ç¤ºèŒƒä¸€é

    ```plain
    ä¾‹å¦‚æˆ‘çš„å¯åŠ¨è„šæœ¬æ˜¯ java -jar server.jar nogui
    â†“
    ç°åœ¨æˆ‘æƒ³è¦è®°å½•æ§åˆ¶å°çš„æ—¥å¿—ï¼Œé‚£å°±ç›´æ¥åœ¨å‚æ•°åé¢åŠ ä¸€ä¸ªâ€œteeâ€å‚æ•°å°±è¡Œäº†
    â†“
    ä¿®æ”¹åçš„å¯åŠ¨è„šæœ¬å°±æ˜¯ java -jar server.jar nogui | tee -a console.log
    â†“
    ç°åœ¨ï¼Œæ§åˆ¶å°çš„æ—¥å¿—ä¼šå®æ—¶ä¿å­˜åœ¨consolo.logæ–‡ä»¶é‡Œï¼Œå…¶ä¸­å¤šå‡ºæ¥çš„å‚æ•° -a ä»£è¡¨â€œappendâ€ï¼ˆè¿½åŠ ï¼‰ï¼Œè¿™æ ·æ¯æ¬¡é‡å¯ä¸ä¼šè¦†ç›–æ‰ä¹‹å‰çš„æ—¥å¿—
    ```

3. â€¦â€¦emmmç¼–ä¸å‡ºæ¥äº†

:::

## å¯åŠ¨è„šæœ¬çš„åŸºæœ¬æ„æˆ

ä¸€ä¸ªæœ€ç®€å•çš„å¯åŠ¨è„šæœ¬åŒ…å«ä»¥ä¸‹å‡ ä¸ªéƒ¨åˆ†ï¼š

```
java -Xms2G -Xmx2G -jar server.jar nogui
```

è®©æˆ‘ä»¬é€ä¸€æ‹†è§£ï¼š

### 1. `java`
è¿™æ˜¯è°ƒç”¨Javaè¿è¡Œç¯å¢ƒçš„å‘½ä»¤ï¼Œå‘Šè¯‰ç³»ç»Ÿä½¿ç”¨Javaæ¥è¿è¡Œåé¢çš„ç¨‹åºã€‚

### 2. `-Xms2G`
è®¾ç½®**æœ€å°å†…å­˜**ï¼ˆInitial memoryï¼‰ï¼Œè¿™é‡Œæ˜¯2GBã€‚
- `Xms` = X Memory Start
- `2G` = 2 Gigabytesï¼ˆ2åƒå…†å­—èŠ‚ï¼‰

### 3. `-Xmx2G`
è®¾ç½®**æœ€å¤§å†…å­˜**ï¼ˆMaximum memoryï¼‰ï¼Œè¿™é‡Œæ˜¯2GBã€‚
- `Xmx` = X Memory maXimum
- `2G` = 2 Gigabytes

**é‡è¦æç¤º**ï¼šå»ºè®®å°†`Xms`å’Œ`Xmx`è®¾ç½®ä¸ºç›¸åŒçš„å€¼ï¼Œè¿™æ ·å¯ä»¥é¿å…JavaåŠ¨æ€è°ƒæ•´å†…å­˜å¸¦æ¥çš„æ€§èƒ½æŸå¤±ã€‚

### 4. `-jar server.jar`
æŒ‡å®šè¦è¿è¡Œçš„æœåŠ¡å™¨æ ¸å¿ƒæ–‡ä»¶ã€‚
- `-jar` è¡¨ç¤ºè¿è¡Œä¸€ä¸ª`.jar`æ ¼å¼çš„ç¨‹åº
- `server.jar` æ˜¯ä½ çš„æœåŠ¡å™¨æ ¸å¿ƒæ–‡ä»¶åï¼ˆéœ€è¦æ ¹æ®å®é™…æ–‡ä»¶åä¿®æ”¹ï¼‰

### 5. `nogui`
è¡¨ç¤ºä¸å¯åŠ¨å›¾å½¢åŒ–ç•Œé¢ï¼Œä½¿ç”¨å‘½ä»¤è¡Œæ¨¡å¼è¿è¡Œã€‚
- å›¾å½¢ç•Œé¢ä¼šæ¶ˆè€—é¢å¤–çš„å†…å­˜å’ŒCPUèµ„æº
- å¤§å¤šæ•°æœåŠ¡å™¨éƒ½ä½¿ç”¨noguiæ¨¡å¼

## ä¸åŒæ“ä½œç³»ç»Ÿçš„è„šæœ¬æ ¼å¼

### Windowsç³»ç»Ÿ

**æ–‡ä»¶æ ¼å¼**ï¼š`.bat` æˆ– `.cmd`

**åŸºç¡€è„šæœ¬ç¤ºä¾‹**ï¼ˆ`start.bat`ï¼‰ï¼š
```batch
@echo off
title MinecraftæœåŠ¡å™¨
java -Xms4G -Xmx4G -jar server.jar nogui
pause
```

**è¯¦ç»†è¯´æ˜**ï¼š
- `@echo off`ï¼šå…³é—­å‘½ä»¤å›æ˜¾ï¼Œè®©çª—å£æ›´ç®€æ´
- `title MinecraftæœåŠ¡å™¨`ï¼šè®¾ç½®çª—å£æ ‡é¢˜
- `pause`ï¼šæœåŠ¡å™¨å…³é—­åæš‚åœï¼Œæ–¹ä¾¿æŸ¥çœ‹é”™è¯¯ä¿¡æ¯

**åˆ›å»ºæ–¹æ³•**ï¼š
1. å³é”®æ¡Œé¢ â†’ æ–°å»º â†’ æ–‡æœ¬æ–‡æ¡£
2. å°†ä¸Šè¿°å†…å®¹ç²˜è´´è¿›å»
3. å¦å­˜ä¸º â†’ æ–‡ä»¶åæ”¹ä¸º`start.bat`ï¼Œæ–‡ä»¶ç±»å‹é€‰æ‹©â€œæ‰€æœ‰æ–‡ä»¶â€
4. ç¡®ä¿æ–‡ä»¶æ‰©å±•åæ˜¯`.bat`è€Œä¸æ˜¯`.bat.txt`

---

### Linuxç³»ç»Ÿ

**æ–‡ä»¶æ ¼å¼**ï¼š`.sh`

**åŸºç¡€è„šæœ¬ç¤ºä¾‹**ï¼ˆ`start.sh`ï¼‰ï¼š
```bash
#!/bin/bash
java -Xms4G -Xmx4G -jar server.jar nogui
```

**è¯¦ç»†è¯´æ˜**ï¼š
- `#!/bin/bash`ï¼šå£°æ˜è¿™æ˜¯ä¸€ä¸ªbashè„šæœ¬ï¼ˆå¿…é¡»æ”¾åœ¨ç¬¬ä¸€è¡Œï¼‰

**åˆ›å»ºæ–¹æ³•**ï¼š
```bash
# åˆ›å»ºè„šæœ¬æ–‡ä»¶
nano start.sh

# ç²˜è´´å†…å®¹åï¼ŒæŒ‰Ctrl+Xï¼Œç„¶åYï¼Œç„¶åEnterä¿å­˜

# ç»™äºˆæ‰§è¡Œæƒé™
chmod +x start.sh

# è¿è¡Œè„šæœ¬
./start.sh
```

---

### macOSç³»ç»Ÿ

**æ–‡ä»¶æ ¼å¼**ï¼š`.command` æˆ– `.sh`

**åŸºç¡€è„šæœ¬ç¤ºä¾‹**ï¼ˆ`start.command`ï¼‰ï¼š
```bash
#!/bin/bash
cd "$(dirname "$0")"
java -Xms4G -Xmx4G -jar server.jar nogui
```

**è¯¦ç»†è¯´æ˜**:
- `cd "$(dirname "$0")"`ï¼šè‡ªåŠ¨åˆ‡æ¢åˆ°è„šæœ¬æ‰€åœ¨ç›®å½•

**åˆ›å»ºæ–¹æ³•**:
```bash
# åˆ›å»ºå¹¶ç¼–è¾‘æ–‡ä»¶
nano start.command

# ç²˜è´´å†…å®¹ï¼Œä¿å­˜

# ç»™äºˆæ‰§è¡Œæƒé™
chmod +x start.command

# åŒå‡»è¿è¡Œæˆ–åœ¨ç»ˆç«¯ä¸­è¿è¡Œ
./start.command
```

## JVMå‚æ•°è¯¦è§£

JVMï¼ˆJava Virtual Machineï¼ŒJavaè™šæ‹Ÿæœºï¼‰å‚æ•°æ§åˆ¶ç€Javaç¨‹åºçš„è¿è¡Œæ–¹å¼ã€‚ä»¥ä¸‹æ˜¯MinecraftæœåŠ¡å™¨å¸¸ç”¨çš„å‚æ•°ï¼š

### å†…å­˜ç›¸å…³å‚æ•°

| å‚æ•° | è¯´æ˜ | ç¤ºä¾‹ |
|------|------|------|
| `-Xms` | åˆå§‹å †å†…å­˜å¤§å° | `-Xms4G` |
| `-Xmx` | æœ€å¤§å †å†…å­˜å¤§å° | `-Xmx4G` |
| `-Xmn` | æ–°ç”Ÿä»£å†…å­˜å¤§å° | `-Xmn1G` |
| `-Xss` | çº¿ç¨‹å †æ ˆå¤§å° | `-Xss1M` |

**å†…å­˜å•ä½è¯´æ˜**:
- `K` æˆ– `k` = KBï¼ˆåƒå­—èŠ‚ï¼‰
- `M` æˆ– `m` = MBï¼ˆå…†å­—èŠ‚ï¼‰
- `G` æˆ– `g` = GBï¼ˆåƒå…†å­—èŠ‚ï¼‰

ç¤ºä¾‹ï¼š`2048M` = `2G` = 2048å…†å­—èŠ‚ = 2åƒå…†å­—èŠ‚

### åƒåœ¾å›æ”¶å™¨å‚æ•°

åƒåœ¾å›æ”¶å™¨ï¼ˆGCï¼‰è´Ÿè´£æ¸…ç†ä¸å†ä½¿ç”¨çš„å†…å­˜ã€‚ä¸åŒçš„GCæœ‰ä¸åŒçš„ç‰¹ç‚¹:

#### 1. G1GCï¼ˆæ¨èç”¨äºå¤§å¤šæ•°æœåŠ¡å™¨ï¼‰
```
-XX:+UseG1GC
```
**ä¼˜ç‚¹**ï¼šå¹³è¡¡æ€§èƒ½å’Œæš‚åœæ—¶é—´ï¼Œé€‚åˆä¸­å¤§å‹æœåŠ¡å™¨

#### 2. ZGCï¼ˆæ¨èç”¨äºå¤§å‹æœåŠ¡å™¨ï¼ŒJava 11+ï¼‰
```
-XX:+UseZGC
```
**ä¼˜ç‚¹**ï¼šè¶…ä½å»¶è¿Ÿï¼Œé€‚åˆå¤§å‹æœåŠ¡å™¨å’Œéœ€è¦æè‡´æµç•…åº¦çš„åœºæ™¯

#### 3. Shenandoah GCï¼ˆJava 12+ï¼‰
```
-XX:+UseShenandoahGC
```
**ä¼˜ç‚¹**ï¼šä½æš‚åœæ—¶é—´ï¼Œä¸ZGCç±»ä¼¼

### æ€§èƒ½ä¼˜åŒ–å‚æ•°

```bash
# å¯ç”¨å¤§é¡µé¢å†…å­˜æ”¯æŒ
-XX:+UseLargePages

# å¯ç”¨NUMAä¼˜åŒ–(å¤šCPUæœåŠ¡å™¨)
-XX:+UseNUMA

# ç¦ç”¨æ˜¾å¼GCè°ƒç”¨
-XX:+DisableExplicitGC

# ä¼˜åŒ–å­—ç¬¦ä¸²å»é‡
-XX:+UseStringDeduplication

# è®¾ç½®GCçº¿ç¨‹æ•°
-XX:ParallelGCThreads=4
```

## å†…å­˜åˆ†é…æŒ‡å—

### åŸºç¡€åˆ†é…å»ºè®®

å¦‚ä½•å†³å®šç»™æœåŠ¡å™¨åˆ†é…å¤šå°‘å†…å­˜ï¼Ÿè¿™æ˜¯æ–°æ‰‹æœä¸»æœ€å¸¸é—®çš„é—®é¢˜ã€‚å¦‚æœä¸çŸ¥é“çš„è¯ï¼Œä½ å°±å‚è€ƒä¸‹é¢è¿™å¼ è¡¨ï¼š

| ç©å®¶æ•°é‡ | æ’ä»¶æ•°é‡ | æ¨èå†…å­˜ | æœ€ä½å†…å­˜ |
|----------|----------|----------|----------|
| 1-5äºº | å°‘é‡ï¼ˆ0-10ï¼‰ | 2-3GB | 1GB |
| 5-10äºº | é€‚ä¸­ï¼ˆ10-30ï¼‰ | 3-4GB | 2GB |
| 10-20äºº | è¾ƒå¤šï¼ˆ30-50ï¼‰ | 4-6GB | 3GB |
| 20-50äºº | å¾ˆå¤šï¼ˆ50+ï¼‰ | 6-10GB | 4GB |
| 50+äºº | å¤§é‡ | 10-16GB+ | 8GB |

### å½±å“å†…å­˜éœ€æ±‚çš„å› ç´ 

1. **ç©å®¶æ•°é‡**ï¼šæ¯ä¸ªç©å®¶å¤§çº¦éœ€è¦50-100MB
2. **ä¸–ç•Œå¤§å°**ï¼šé¢„ç”Ÿæˆçš„ä¸–ç•Œè¶Šå¤§ï¼Œéœ€è¦çš„å†…å­˜è¶Šå¤š
3. **æ’ä»¶æ•°é‡å’Œç±»å‹**ï¼š
   - ç®€å•æ’ä»¶ï¼ˆå¦‚ä¼ é€ã€æƒé™ï¼‰ï¼š10-50MB
   - å¤æ‚æ’ä»¶ï¼ˆå¦‚ç»æµç³»ç»Ÿã€RPGï¼‰ï¼š50-200MB
   - å¤§å‹æ’ä»¶ï¼ˆå¦‚åœ°çš®ã€å°æ¸¸æˆï¼‰ï¼š200MB+
4. **MODæ•°é‡**ï¼šæ¯ä¸ªMODå¹³å‡éœ€è¦50-500MBä¸ç­‰
5. **è§†è·è®¾ç½®**ï¼šè§†è·æ¯å¢åŠ 1ï¼Œå†…å­˜éœ€æ±‚å¢åŠ çº¦10-15%

### é»„é‡‘æ³•åˆ™

1. **ä¸è¦åˆ†é…è¶…è¿‡ç³»ç»Ÿæ€»å†…å­˜çš„70%ï¼ï¼**
   - ä¾‹ï¼š8GBç³»ç»Ÿå†…å­˜ â†’ æœ€å¤šåˆ†é…5-6GBç»™æœåŠ¡å™¨
   
2. **ä¸ºæ“ä½œç³»ç»Ÿé¢„ç•™è‡³å°‘1-2GBå†…å­˜ï¼ï¼**
   - Windowséœ€è¦æ›´å¤š(2-3GB)
   - Linuxå¯ä»¥æ›´å°‘(1-2GB)

3. **Xmså’ŒXmxè®¾ç½®ç›¸åŒå€¼æ›´å¥½ï¼ï¼**
   - å¥½ï¼š`-Xms4G -Xmx4G`
   - å·®ï¼š`-Xms2G -Xmx4G`

4. **ä¸æ˜¯è¶Šå¤§è¶Šå¥½ï¼ï¼**
   - è¿‡å¤šå†…å­˜ä¼šå¯¼è‡´GCæš‚åœæ—¶é—´è¿‡é•¿
   - ä¸€èˆ¬ä¸å»ºè®®è¶…è¿‡16GB(é™¤éæ˜¯è¶…å¤§å‹æœåŠ¡å™¨)

## ä¼˜åŒ–å¯åŠ¨å‚æ•°

::: note é˜²æ­§ä¹‰
è¿™é‡Œæ‰€è¯´çš„ä¼˜åŒ–ï¼Œä¸æ˜¯æŠŠå¯åŠ¨å‚æ•°ä¼˜åŒ–ï¼Œè€Œæ˜¯è·Ÿä¼˜åŒ–ç›¸å…³çš„å¯åŠ¨å‚æ•°
:::

ä»¥ä¸‹æ˜¯é’ˆå¯¹ä¸åŒåœºæ™¯çš„ä¼˜åŒ–å¯åŠ¨å‚æ•°é…ç½®ã€‚

### é€‚ç”¨äºå°å‹æœåŠ¡å™¨ï¼ˆ1-10äººï¼‰

ï¼ˆ**Windowsç‰ˆæœ¬**ï¼‰
```batch title="start.bat"
@echo off
title Minecraftå°å‹æœåŠ¡å™¨
java -Xms2G -Xmx2G ^
-XX:+UseG1GC ^
-XX:+ParallelRefProcEnabled ^
-XX:MaxGCPauseMillis=200 ^
-XX:+UnlockExperimentalVMOptions ^
-XX:+DisableExplicitGC ^
-XX:G1NewSizePercent=30 ^
-XX:G1MaxNewSizePercent=40 ^
-XX:G1HeapRegionSize=8M ^
-XX:G1ReservePercent=20 ^
-XX:G1HeapWastePercent=5 ^
-XX:G1MixedGCCountTarget=4 ^
-XX:InitiatingHeapOccupancyPercent=15 ^
-XX:G1MixedGCLiveThresholdPercent=90 ^
-XX:SurvivorRatio=32 ^
-jar server.jar nogui
pause
```

ï¼ˆ**Linux/Macç‰ˆæœ¬**ï¼‰
```bash title="start.sh"
#!/bin/bash
java -Xms2G -Xmx2G \
-XX:+UseG1GC \
-XX:+ParallelRefProcEnabled \
-XX:MaxGCPauseMillis=200 \
-XX:+UnlockExperimentalVMOptions \
-XX:+DisableExplicitGC \
-XX:G1NewSizePercent=30 \
-XX:G1MaxNewSizePercent=40 \
-XX:G1HeapRegionSize=8M \
-XX:G1ReservePercent=20 \
-XX:G1HeapWastePercent=5 \
-XX:G1MixedGCCountTarget=4 \
-XX:InitiatingHeapOccupancyPercent=15 \
-XX:G1MixedGCLiveThresholdPercent=90 \
-XX:SurvivorRatio=32 \
-jar server.jar nogui
```

---

### é€‚ç”¨äºä¸­å‹æœåŠ¡å™¨ï¼ˆ10-30äººï¼‰

ï¼ˆ**Windowsç‰ˆæœ¬**ï¼‰
```batch
@echo off
title Minecraftä¸­å‹æœåŠ¡å™¨
java -Xms4G -Xmx4G ^
-XX:+UseG1GC ^
-XX:+ParallelRefProcEnabled ^
-XX:MaxGCPauseMillis=200 ^
-XX:+UnlockExperimentalVMOptions ^
-XX:+DisableExplicitGC ^
-XX:+AlwaysPreTouch ^
-XX:G1NewSizePercent=40 ^
-XX:G1MaxNewSizePercent=50 ^
-XX:G1HeapRegionSize=16M ^
-XX:G1ReservePercent=15 ^
-XX:G1HeapWastePercent=5 ^
-XX:G1MixedGCCountTarget=4 ^
-XX:InitiatingHeapOccupancyPercent=20 ^
-XX:G1MixedGCLiveThresholdPercent=90 ^
-XX:G1RSetUpdatingPauseTimePercent=5 ^
-XX:SurvivorRatio=32 ^
-XX:+PerfDisableSharedMem ^
-XX:MaxTenuringThreshold=1 ^
-jar server.jar nogui
pause
```

---

### é€‚ç”¨äºå¤§å‹æœåŠ¡å™¨ï¼ˆ30+äººï¼Œæ¨èä½¿ç”¨ZGCï¼‰

**å‰ææ¡ä»¶**ï¼šJava 17æˆ–æ›´é«˜ç‰ˆæœ¬

ï¼ˆ**Windowsç‰ˆæœ¬**ï¼‰
```batch
@echo off
title Minecraftå¤§å‹æœåŠ¡å™¨
java -Xms8G -Xmx8G ^
-XX:+UseZGC ^
-XX:+UnlockExperimentalVMOptions ^
-XX:+DisableExplicitGC ^
-XX:+AlwaysPreTouch ^
-XX:+ParallelRefProcEnabled ^
-XX:-ZUncommit ^
-XX:ZUncommitDelay=300 ^
-XX:ZCollectionInterval=5 ^
-XX:ZAllocationSpikeTolerance=2.0 ^
-XX:+UseLargePages ^
-XX:+PerfDisableSharedMem ^
-jar server.jar nogui
pause
```

---

### Aikar's Flagsï¼ˆç¤¾åŒºæ¨èå‚æ•°ï¼‰

Aikaræ˜¯PaperæœåŠ¡ç«¯çš„å¼€å‘è€…ï¼Œä»–æä¾›äº†ä¸€å¥—å¹¿å—å¥½è¯„çš„å¯åŠ¨å‚æ•°ï¼š

ï¼ˆ**é€‚ç”¨äºJava 8-10**ï¼‰
```bash
java -Xms10G -Xmx10G \
-XX:+UseG1GC \
-XX:+ParallelRefProcEnabled \
-XX:MaxGCPauseMillis=200 \
-XX:+UnlockExperimentalVMOptions \
-XX:+DisableExplicitGC \
-XX:+AlwaysPreTouch \
-XX:G1NewSizePercent=30 \
-XX:G1MaxNewSizePercent=40 \
-XX:G1HeapRegionSize=8M \
-XX:G1ReservePercent=20 \
-XX:G1HeapWastePercent=5 \
-XX:G1MixedGCCountTarget=4 \
-XX:InitiatingHeapOccupancyPercent=15 \
-XX:G1MixedGCLiveThresholdPercent=90 \
-XX:G1RSetUpdatingPauseTimePercent=5 \
-XX:SurvivorRatio=32 \
-XX:+PerfDisableSharedMem \
-XX:MaxTenuringThreshold=1 \
-jar server.jar nogui
```

ï¼ˆ**é€‚ç”¨äºJava 11+**ï¼‰
```bash
java -Xms10G -Xmx10G \
-XX:+UseG1GC \
-XX:+ParallelRefProcEnabled \
-XX:MaxGCPauseMillis=200 \
-XX:+UnlockExperimentalVMOptions \
-XX:+DisableExplicitGC \
-XX:+AlwaysPreTouch \
-XX:G1NewSizePercent=40 \
-XX:G1MaxNewSizePercent=50 \
-XX:G1HeapRegionSize=16M \
-XX:G1ReservePercent=15 \
-XX:G1HeapWastePercent=5 \
-XX:G1MixedGCCountTarget=4 \
-XX:InitiatingHeapOccupancyPercent=20 \
-XX:G1MixedGCLiveThresholdPercent=90 \
-XX:G1RSetUpdatingPauseTimePercent=5 \
-XX:SurvivorRatio=32 \
-XX:+PerfDisableSharedMem \
-XX:MaxTenuringThreshold=1 \
-jar server.jar nogui
```

## ä¸€äº›å®ç”¨è„šæœ¬ <Badge type="tip" text="æ‹“å±•" />

### 1. è‡ªåŠ¨é‡å¯è„šæœ¬

è®©æœåŠ¡å™¨å´©æºƒæ—¶è‡ªå·±é‡å¯ï¼š

ï¼ˆ**Windowsç‰ˆæœ¬**ï¼‰
```batch title="start_loop.bat"
@echo off
title MinecraftæœåŠ¡å™¨ - è‡ªåŠ¨é‡å¯
:start
echo æ­£åœ¨å¯åŠ¨æœåŠ¡å™¨...
echo å¯åŠ¨æ—¶é—´ï¼š%date% %time%
java -Xms4G -Xmx4G -jar server.jar nogui
echo.
echo æœåŠ¡å™¨å·²å…³é—­!
echo å…³é—­æ—¶é—´ï¼š%date% %time%
echo.
echo 10ç§’åè‡ªåŠ¨é‡å¯...
timeout /t 10
goto start
```

ï¼ˆ**Linuxç‰ˆæœ¬**ï¼‰
```bash title="start_loop.sh"
#!/bin/bash
while true; do
    echo "æ­£åœ¨å¯åŠ¨æœåŠ¡å™¨..."
    echo "å¯åŠ¨æ—¶é—´ï¼š$(date)"
    java -Xms4G -Xmx4G -jar server.jar nogui
    echo ""
    echo "æœåŠ¡å™¨å·²å…³é—­!"
    echo "å…³é—­æ—¶é—´ï¼š$(date)"
    echo ""
    echo "10ç§’åè‡ªåŠ¨é‡å¯..."
    sleep 10
done
```

---

### 2. å¸¦æ—¥å¿—è®°å½•çš„è„šæœ¬

è®°å½•æœåŠ¡å™¨è¿è¡Œæ—¥å¿—:

**Windowsç‰ˆæœ¬**:
```batch
@echo off
title MinecraftæœåŠ¡å™¨ - æ—¥å¿—è®°å½•
set LOG_DIR=logs
if not exist %LOG_DIR% mkdir %LOG_DIR%
set LOG_FILE=%LOG_DIR%\server_%date:~0,4%%date:~5,2%%date:~8,2%_%time:~0,2%%time:~3,2%%time:~6,2%.log

echo å¯åŠ¨æœåŠ¡å™¨,æ—¥å¿—æ–‡ä»¶ï¼š%LOG_FILE%
java -Xms4G -Xmx4G -jar server.jar nogui 2>&1 | tee %LOG_FILE%
pause
```

**Linuxç‰ˆæœ¬**:
```bash
#!/bin/bash
LOG_DIR="logs"
mkdir -p $LOG_DIR
LOG_FILE="$LOG_DIR/server_$(date +%Y%m%d_%H%M%S).log"

echo "å¯åŠ¨æœåŠ¡å™¨ï¼Œæ—¥å¿—æ–‡ä»¶ï¼š$LOG_FILE"
java -Xms4G -Xmx4G -jar server.jar nogui 2>&1 | tee $LOG_FILE
```

---

### 3. æ£€æµ‹Javaç‰ˆæœ¬çš„è„šæœ¬

è‡ªåŠ¨æ£€æµ‹å¹¶ä½¿ç”¨æ­£ç¡®çš„Javaç‰ˆæœ¬ï¼š

ï¼ˆ**Windowsç‰ˆæœ¬**ï¼‰
```batch
@echo off
title MinecraftæœåŠ¡å™¨ - Javaç‰ˆæœ¬æ£€æµ‹

echo æ£€æµ‹Javaç‰ˆæœ¬...
java -version 2>&1 | findstr /i "version" > java_version.txt
set /p JAVA_VER=<java_version.txt
del java_version.txt

echo å½“å‰Javaç‰ˆæœ¬ï¼š%JAVA_VER%
echo.

REM æ£€æŸ¥æ˜¯å¦å®‰è£…äº†Java
java -version >nul 2>&1
if errorlevel 1 (
    echo é”™è¯¯ï¼šæœªæ£€æµ‹åˆ°Java!
    echo è¯·å…ˆå®‰è£…Javaï¼šhttps://adoptium.net/
    pause
    exit
)

echo Javaæ£€æµ‹é€šè¿‡ï¼Œå¯åŠ¨æœåŠ¡å™¨...
java -Xms4G -Xmx4G -jar server.jar nogui
pause
```

ï¼ˆ**Linuxç‰ˆæœ¬**ï¼‰
```bash
#!/bin/bash

echo "æ£€æµ‹Javaç‰ˆæœ¬..."
if ! command -v java &> /dev/null; then
    echo "é”™è¯¯ï¼šæœªæ£€æµ‹åˆ°Java!"
    echo "è¯·å…ˆå®‰è£…Java"
    exit 1
fi

JAVA_VER=$(java -version 2>&1 | head -n 1)
echo "å½“å‰Javaç‰ˆæœ¬ï¼š$JAVA_VER"
echo ""

echo "Javaæ£€æµ‹é€šè¿‡ï¼Œå¯åŠ¨æœåŠ¡å™¨..."
java -Xms4G -Xmx4G -jar server.jar nogui
```

---

### 4. å¸¦æ€§èƒ½ç›‘æ§çš„è„šæœ¬

ï¼ˆ**Linuxç‰ˆæœ¬**ï¼‰ï¼ˆéœ€è¦å®‰è£…screenï¼‰ï¼š
```bash
#!/bin/bash

# æœåŠ¡å™¨é…ç½®
SERVER_JAR="server.jar"
MEMORY="4G"
SCREEN_NAME="minecraft"

# æ£€æŸ¥screenæ˜¯å¦å®‰è£…
if ! command -v screen &> /dev/null; then
    echo "é”™è¯¯ï¼šæœªå®‰è£…screen"
    echo "è¯·è¿è¡Œï¼šsudo apt-get install screen"
    exit 1
fi

# æ£€æŸ¥æ˜¯å¦å·²ç»åœ¨è¿è¡Œ
if screen -list | grep -q "$SCREEN_NAME"; then
    echo "æœåŠ¡å™¨å·²ç»åœ¨è¿è¡Œä¸­!"
    echo "ä½¿ç”¨ 'screen -r $SCREEN_NAME' è¿æ¥åˆ°æœåŠ¡å™¨æ§åˆ¶å°"
    exit 1
fi

# å¯åŠ¨æœåŠ¡å™¨
echo "åœ¨screenä¼šè¯ä¸­å¯åŠ¨æœåŠ¡å™¨..."
screen -dmS $SCREEN_NAME java -Xms$MEMORY -Xmx$MEMORY \
    -XX:+UseG1GC \
    -XX:+ParallelRefProcEnabled \
    -XX:MaxGCPauseMillis=200 \
    -XX:+UnlockExperimentalVMOptions \
    -jar $SERVER_JAR nogui

echo "æœåŠ¡å™¨å·²å¯åŠ¨!"
echo "ä½¿ç”¨ 'screen -r $SCREEN_NAME' è¿æ¥åˆ°æœåŠ¡å™¨æ§åˆ¶å°"
echo "æŒ‰ Ctrl+A ç„¶åæŒ‰ D å¯ä»¥æ–­å¼€è¿æ¥(æœåŠ¡å™¨ç»§ç»­è¿è¡Œ)"
```

---

## å¸¸è§é—®é¢˜è§£ç­”ï¼ˆFAQï¼‰

### 1. æ— æ³•è¯†åˆ«'java'å‘½ä»¤

**ç—‡çŠ¶**:
```
'java' ä¸æ˜¯å†…éƒ¨æˆ–å¤–éƒ¨å‘½ä»¤ï¼Œä¹Ÿä¸æ˜¯å¯è¿è¡Œçš„ç¨‹åºæˆ–æ‰¹å¤„ç†æ–‡ä»¶ã€‚
```

**åŸå› **ï¼šæ²¡æœ‰å®‰è£…Javaæˆ–Javaæ²¡æœ‰æ·»åŠ åˆ°ç³»ç»Ÿç¯å¢ƒå˜é‡

**è§£å†³æ–¹æ¡ˆ**:

1. **ä¸‹è½½å¹¶å®‰è£…Java**:
   - æ¨èä½¿ç”¨ [Adoptium (Eclipse Temurin)](https://adoptium.net/)
   - æˆ–è€…ä½¿ç”¨ [Oracle Java](https://www.oracle.com/java/technologies/downloads/)

2. **éªŒè¯å®‰è£…**:
   æ‰“å¼€å‘½ä»¤æç¤ºç¬¦/ç»ˆç«¯ï¼Œè¾“å…¥:
   ```bash
   java -version
   ```
   åº”è¯¥æ˜¾ç¤ºJavaç‰ˆæœ¬ä¿¡æ¯

3. **æ‰‹åŠ¨è®¾ç½®ç¯å¢ƒå˜é‡**(Windows):
   - å³é”®"æ­¤ç”µè„‘" â†’ å±æ€§ â†’ é«˜çº§ç³»ç»Ÿè®¾ç½® â†’ ç¯å¢ƒå˜é‡
   - åœ¨ç³»ç»Ÿå˜é‡ä¸­æ‰¾åˆ°`Path`ï¼Œç‚¹å‡»ç¼–è¾‘
   - æ·»åŠ Javaçš„binç›®å½•è·¯å¾„(ä¾‹ï¼š`C:\Program Files\Java\jdk-17\bin`)

---

### 2. æ‰¾ä¸åˆ°æˆ–æ— æ³•åŠ è½½ä¸»ç±»

**ç—‡çŠ¶**:
```
Error: Could not find or load main class
```

**åŸå› **ï¼š
- æœåŠ¡å™¨jaræ–‡ä»¶æŸå
- jaræ–‡ä»¶åæ‹¼å†™é”™è¯¯
- jaræ–‡ä»¶ä¸åœ¨æ­£ç¡®çš„ç›®å½•

**è§£å†³æ–¹æ¡ˆ**:

1. **æ£€æŸ¥æ–‡ä»¶å**ï¼šç¡®ä¿è„šæœ¬ä¸­çš„jaræ–‡ä»¶åä¸å®é™…æ–‡ä»¶åå®Œå…¨ä¸€è‡´
   ```batch
   REM å¦‚æœä½ çš„æ–‡ä»¶å« paper-1.20.4.jar
   java -Xms4G -Xmx4G -jar paper-1.20.4.jar nogui
   ```

2. **æ£€æŸ¥æ–‡ä»¶ä½ç½®**ï¼šç¡®ä¿jaræ–‡ä»¶å’Œå¯åŠ¨è„šæœ¬åœ¨åŒä¸€ç›®å½•

3. **é‡æ–°ä¸‹è½½jaræ–‡ä»¶**ï¼šæ–‡ä»¶å¯èƒ½å·²æŸå

---

### 3. å†…å­˜ä¸è¶³ / OutOfMemoryError

**ç—‡çŠ¶**:
```
java.lang.OutOfMemoryError: Java heap space
```

**åŸå› **ï¼šåˆ†é…çš„å†…å­˜ä¸è¶³

**è§£å†³æ–¹æ¡ˆ**:

1. **å¢åŠ å†…å­˜åˆ†é…**:
   ```bash
   REM å°†2Gæ”¹ä¸º4Gæˆ–æ›´é«˜
   java -Xms4G -Xmx4G -jar server.jar nogui
   ```

2. **æ£€æŸ¥ç³»ç»Ÿå¯ç”¨å†…å­˜**:
   - Windowsï¼šä»»åŠ¡ç®¡ç†å™¨ â†’ æ€§èƒ½ â†’ å†…å­˜
   - Linuxï¼š`free -h`

3. **ç¡®ä¿ä¸è¶…è¿‡ç³»ç»Ÿæ€»å†…å­˜çš„70%**

---

### 4. æœåŠ¡å™¨é¢‘ç¹å¡é¡¿/TPSä½

**ç—‡çŠ¶**ï¼š
- ç©å®¶ç§»åŠ¨å¡é¡¿
- æ–¹å—æ”¾ç½®å»¶è¿Ÿ
- TPS(æ¯ç§’åˆ»æ•°)ä½äº20

**å¯èƒ½åŸå› å’Œè§£å†³æ–¹æ¡ˆ**:

1. **å†…å­˜ä¸è¶³**:
   - å¢åŠ Xmså’ŒXmxå€¼

2. **åƒåœ¾å›æ”¶å‚æ•°ä¸å½“**:
   - ä½¿ç”¨æœ¬æ•™ç¨‹æ¨èçš„ä¼˜åŒ–å‚æ•°
   - å°è¯•åˆ‡æ¢åˆ°ZGC(Java 17+)

3. **æ’ä»¶/MODè¿‡å¤š**:
   - ä½¿ç”¨timingsæˆ–sparkåˆ†ææ€§èƒ½
   - ç§»é™¤ä¸å¿…è¦çš„æ’ä»¶
   - ä¼˜åŒ–æ’ä»¶é…ç½®

4. **ä¸–ç•Œè¿‡å¤§**:
   - ä½¿ç”¨WorldBorderé™åˆ¶ä¸–ç•Œå¤§å°
   - å®šæœŸæ¸…ç†æœªä½¿ç”¨çš„åŒºå—

---

### 5. å¯åŠ¨åç«‹å³å…³é—­

**ç—‡çŠ¶**ï¼šåŒå‡»è„šæœ¬åçª—å£ä¸€é—ªè€Œè¿‡

**è§£å†³æ–¹æ¡ˆ**:

1. **åœ¨è„šæœ¬æœ«å°¾æ·»åŠ pause**(Windows):
   ```batch
   java -Xms4G -Xmx4G -jar server.jar nogui
   pause
   ```

2. **æŸ¥çœ‹æ—¥å¿—æ–‡ä»¶**ï¼š
   - æ‰“å¼€`logs/latest.log`æŸ¥çœ‹é”™è¯¯ä¿¡æ¯

3. **å¸¸è§åŸå› **:
   - æ²¡æœ‰åŒæ„EULAï¼šç¼–è¾‘`eula.txt`ï¼Œå°†`eula=false`æ”¹ä¸º`eula=true`
   - ç«¯å£è¢«å ç”¨ï¼šä¿®æ”¹`server.properties`ä¸­çš„ç«¯å£å·
   - Javaç‰ˆæœ¬ä¸å…¼å®¹ï¼šå‡çº§æˆ–é™çº§Javaç‰ˆæœ¬

---

### 6. Unsupported class file major version

**ç—‡çŠ¶**:
```
Unsupported class file major version XX
```

**åŸå› **ï¼šJavaç‰ˆæœ¬è¿‡ä½ï¼Œä¸æ”¯æŒè¯¥æœåŠ¡å™¨ç‰ˆæœ¬

**è§£å†³æ–¹æ¡ˆ**:

ä¸åŒMinecraftç‰ˆæœ¬éœ€è¦çš„æœ€ä½Javaç‰ˆæœ¬:
- Minecraft 1.16åŠä»¥ä¸‹ï¼šJava 8+
- Minecraft 1.17ï¼šJava 16+
- Minecraft 1.18-1.20.4ï¼šJava 17+
- Minecraft 1.20.5+ï¼šJava 21+

å‡çº§åˆ°å¯¹åº”æˆ–æ›´é«˜ç‰ˆæœ¬çš„Javaå³å¯ã€‚

## ä¸€äº›å°å¦™æ‹› <Badge type="tip" text="æ‹“å±•" />

### 1. ä½¿ç”¨screenæˆ–tmuxä¿æŒæœåŠ¡å™¨åå°è¿è¡Œ <Badge type="info" text="Linux" />

**å®‰è£…screen**:
```bash
sudo apt-get install screen  # Ubuntu/Debian
sudo yum install screen       # CentOS/RHEL
```

**ä½¿ç”¨æ–¹æ³•**:
```bash
# åˆ›å»ºæ–°çš„screenä¼šè¯å¹¶å¯åŠ¨æœåŠ¡å™¨
screen -S minecraft
./start.sh

# æŒ‰ Ctrl+A ç„¶åæŒ‰ D æ¥æ–­å¼€è¿æ¥(æœåŠ¡å™¨ç»§ç»­è¿è¡Œ)

# é‡æ–°è¿æ¥åˆ°ä¼šè¯
screen -r minecraft

# åˆ—å‡ºæ‰€æœ‰screenä¼šè¯
screen -ls
```

---

### 2. å®šæ—¶è‡ªåŠ¨å¤‡ä»½

**Linuxç‰ˆæœ¬**ï¼ˆä½¿ç”¨cronï¼‰ï¼š

åˆ›å»ºå¤‡ä»½è„šæœ¬ `backup.sh`:
```bash
#!/bin/bash
BACKUP_DIR="/home/minecraft/backups"
SERVER_DIR="/home/minecraft/server"
DATE=$(date +%Y%m%d_%H%M%S)

mkdir -p $BACKUP_DIR
tar -czf $BACKUP_DIR/backup_$DATE.tar.gz -C $SERVER_DIR world world_nether world_the_end

# åªä¿ç•™æœ€è¿‘7å¤©çš„å¤‡ä»½
find $BACKUP_DIR -name "backup_*.tar.gz" -mtime +7 -delete

echo "å¤‡ä»½å®Œæˆï¼šbackup_$DATE.tar.gz"
```

è®¾ç½®å®šæ—¶ä»»åŠ¡:
```bash
# ç¼–è¾‘crontab
crontab -e

# æ·»åŠ ä»¥ä¸‹è¡Œ(æ¯å¤©å‡Œæ™¨3ç‚¹è‡ªåŠ¨å¤‡ä»½)
0 3 * * * /home/minecraft/backup.sh
```

---

### 3. æ€§èƒ½ç›‘æ§å’Œåˆ†æ

**å®‰è£…Sparkæ’ä»¶** <Badge type="tip" text="æ¨è" />

1. ä¸‹è½½Sparkï¼š[https://spark.lucko.me/download](https://spark.lucko.me/download)
2. å°†jaræ–‡ä»¶æ”¾å…¥`plugins`æ–‡ä»¶å¤¹
3. é‡å¯æœåŠ¡å™¨

**ä½¿ç”¨æ–¹æ³•**:
```
# åœ¨æ¸¸æˆä¸­æˆ–æ§åˆ¶å°è¾“å…¥
/spark profiler start

# ç­‰å¾…30-60ç§’å
/spark profiler stop

# ç”ŸæˆæŠ¥å‘Š
/spark profiler open
```

è¿™ä¼šç”Ÿæˆä¸€ä¸ªç½‘é¡µé“¾æ¥ï¼Œå¯ä»¥è¯¦ç»†æŸ¥çœ‹å“ªäº›æ’ä»¶ã€å®ä½“ã€åŒºå—å ç”¨äº†æœ€å¤šèµ„æºã€‚

---

### 4. ç¾¤ç»„æœ <Badge type="info" text="BungeeCord / Velocity" />

> è¯¦æƒ…è§ï¼š[ç¾¤ç»„æœå…¥é—¨](/guide/ji-chu-zhi-shi-xue-xi/group-server/)

å¦‚æœä½ æƒ³è¿è¡Œå¤šä¸ªæœåŠ¡å™¨ï¼ˆå¦‚å¤§å…ã€ç”Ÿå­˜ã€å°æ¸¸æˆï¼‰ï¼š

**è¯•è¯•Velocityï¼Ÿ** <Badge type="tip" text="æ¨è" />

1. ä¸‹è½½Velocityï¼š[https://papermc.io/downloads/velocity](https://papermc.io/downloads/velocity)
2. åˆ›å»ºä¸»å¯åŠ¨è„šæœ¬ï¼š

```bash
#!/bin/bash

# å¯åŠ¨Velocityä»£ç†
cd /home/minecraft/velocity
screen -dmS velocity java -Xms512M -Xmx512M -jar velocity.jar

# å¯åŠ¨å¤§å…æœåŠ¡å™¨
cd /home/minecraft/lobby
screen -dmS lobby java -Xms2G -Xmx2G -jar server.jar nogui

# å¯åŠ¨ç”Ÿå­˜æœåŠ¡å™¨
cd /home/minecraft/survival
screen -dmS survival java -Xms4G -Xmx4G -jar server.jar nogui

echo "æ‰€æœ‰æœåŠ¡å™¨å·²å¯åŠ¨!"
screen -ls
```

---

### 5. ä¼˜åŒ–å¯åŠ¨é€Ÿåº¦

**é¢„ç”Ÿæˆä¸–ç•Œ**ï¼š

ä½¿ç”¨Chunkyæ’ä»¶é¢„ç”Ÿæˆä¸–ç•Œå¯ä»¥é¿å…ç©å®¶æ¢ç´¢æ—¶çš„å¡é¡¿ï¼š

```
# åœ¨æ§åˆ¶å°æˆ–æ¸¸æˆä¸­æ‰§è¡Œ
chunky world world
chunky radius 5000
chunky start

# è¿™ä¼šé¢„ç”ŸæˆåŠå¾„5000æ ¼çš„ä¸–ç•Œ
```

**å¯ç”¨AlwaysPreTouch**ï¼š

åœ¨å¯åŠ¨å‚æ•°ä¸­æ·»åŠ :
```
-XX:+AlwaysPreTouch
```

è¿™ä¼šåœ¨å¯åŠ¨æ—¶é¢„å…ˆåˆ†é…å†…å­˜ï¼Œé¿å…è¿è¡Œæ—¶åˆ†é…å¯¼è‡´çš„å¡é¡¿ã€‚

---

### 6. ä½¿ç”¨RAM Disk <Badge type="tip" text="é«˜çº§" />

å°†æœåŠ¡å™¨è¿è¡Œåœ¨å†…å­˜ä¸­å¯ä»¥æå¤§æå‡IOæ€§èƒ½:

ï¼ˆ**Linuxç‰ˆæœ¬**ï¼‰
```bash
# åˆ›å»º4GBçš„RAM Disk
sudo mkdir /mnt/ramdisk
sudo mount -t tmpfs -o size=4G tmpfs /mnt/ramdisk

# å¤åˆ¶æœåŠ¡å™¨æ–‡ä»¶åˆ°RAM Disk
cp -r /home/minecraft/server/* /mnt/ramdisk/

# åœ¨RAM Diskä¸­è¿è¡ŒæœåŠ¡å™¨
cd /mnt/ramdisk
./start.sh
```

::: warning
RAM Diskä¸­çš„æ•°æ®åœ¨é‡å¯åä¼šä¸¢å¤±ï¼Œéœ€è¦å®šæœŸå¤‡ä»½åˆ°ç¡¬ç›˜!
:::

---

### 7. Dockerå®¹å™¨åŒ–éƒ¨ç½²

ä½¿ç”¨Dockerå¯ä»¥ç®€åŒ–æœåŠ¡å™¨éƒ¨ç½²å’Œç®¡ç†ï¼š

åˆ›å»º `docker-compose.yml`ï¼š
```yaml title="docker-compose.yml"
version: '3'
services:
  minecraft:
    image: itzg/minecraft-server
    ports:
      - "25565:25565"
    environment:
      EULA: "TRUE"
      TYPE: "PAPER"
      VERSION: "1.20.4"
      MEMORY: "4G"
    volumes:
      - ./data:/data
    restart: unless-stopped
```

è¿è¡Œ:
```bash
docker-compose up -d
```

## æ€»ç»“

### ä¸€ä»½checklist

âœ… **å¿…åš**:
- [x] å§‹ç»ˆä½¿ç”¨å¯åŠ¨è„šæœ¬ï¼Œä¸è¦åŒå‡»jaræ–‡ä»¶
- [x] è®¾ç½® `Xms` å’Œ `Xmx` ä¸ºç›¸åŒå€¼
- [x] æ ¹æ®æœåŠ¡å™¨è§„æ¨¡åˆç†åˆ†é…å†…å­˜
- [x] ä½¿ç”¨æ¨èçš„åƒåœ¾å›æ”¶å™¨ï¼ˆ`G1GC` æˆ– `ZGC`ï¼‰
- [x] å®šæœŸå¤‡ä»½æœåŠ¡å™¨æ•°æ®
- [x] ç›‘æ§æœåŠ¡å™¨æ€§èƒ½ï¼ŒåŠæ—¶ä¼˜åŒ–

âŒ **é¿å…**:
- [ ] åˆ†é…è¶…è¿‡ç³»ç»Ÿ70%çš„å†…å­˜
- [ ] ä½¿ç”¨è¿‡æ—¶çš„GCå‚æ•°ï¼ˆå¦‚CMSï¼‰
- [ ] é¢‘ç¹ä¿®æ”¹å¯åŠ¨å‚æ•°ï¼ˆç»™æ¯æ¬¡è°ƒæ•´è¶³å¤Ÿçš„æµ‹è¯•æ—¶é—´ï¼‰
- [ ] å¿½ç•¥æœåŠ¡å™¨æ—¥å¿—ä¸­çš„è­¦å‘Š

### ä½ éœ€è¦è®°ä½çš„

å¯åŠ¨è„šæœ¬æ˜¯è¿è¡ŒMinecraftæœåŠ¡å™¨çš„åŸºç¡€ï¼ŒæŒæ¡å¥½å¯åŠ¨è„šæœ¬çš„é…ç½®å¯ä»¥è®©ä½ çš„æœåŠ¡å™¨æ€§èƒ½æå‡ä¸€ä¸ªæ¡£æ¬¡ã€‚

è®°ä½ä»¥ä¸‹è¦ç‚¹ï¼š
- **ä»ç®€å•å¼€å§‹**ï¼šå…ˆä½¿ç”¨åŸºç¡€è„šæœ¬ï¼Œç†Ÿæ‚‰åå†é€æ­¥ä¼˜åŒ–
- **ç†è§£å‚æ•°å«ä¹‰**ï¼šä¸è¦ç›²ç›®å¤åˆ¶å‚æ•°ï¼Œç†è§£æ¯ä¸ªå‚æ•°çš„ä½œç”¨
- **ç›‘æ§å’Œè°ƒæ•´**ï¼šå®šæœŸæ£€æŸ¥æœåŠ¡å™¨æ€§èƒ½ï¼Œæ ¹æ®å®é™…æƒ…å†µè°ƒæ•´
- **å¤‡ä»½è‡³ä¸Š**ï¼šåœ¨ä¿®æ”¹é…ç½®å‰åŠ¡å¿…å¤‡ä»½

ç¥ä½ ~~ç¥ä½ ç¥ä½ ç¥ä½ ç¥ä½ ~~æ­å»ºæœåŠ¡å™¨é¡ºåˆ©ï¼Œç©å¾—å¼€å¿ƒï¼ï¼ï¼ğŸ®

## é™„å½•ï¼šå¿«é€Ÿå‚è€ƒ

### å¿«é€Ÿå¯åŠ¨è„šæœ¬æ¨¡æ¿

**Windows - å°å‹æœåŠ¡å™¨ï¼ˆ2GBï¼‰**ï¼š
```batch
@echo off
java -Xms2G -Xmx2G -XX:+UseG1GC -jar server.jar nogui
pause
```

**Windows - ä¸­å‹æœåŠ¡å™¨ï¼ˆ4GBï¼‰**ï¼š
```batch
@echo off
java -Xms4G -Xmx4G -XX:+UseG1GC -jar server.jar nogui
pause
```

**Linux - å°å‹æœåŠ¡å™¨ï¼ˆ2GBï¼‰**ï¼š
```bash
#!/bin/bash
java -Xms2G -Xmx2G -XX:+UseG1GC -jar server.jar nogui
```

**Linux - ä¸­å‹æœåŠ¡å™¨ï¼ˆ4GBï¼‰**ï¼š
```bash
#!/bin/bash
java -Xms4G -Xmx4G -XX:+UseG1GC -jar server.jar nogui
```

---

### æ•…éšœæ’æŸ¥é€ŸæŸ¥è¡¨

| é—®é¢˜ | æ£€æŸ¥é¡¹ | è§£å†³æ–¹æ¡ˆ |
|------|--------|----------|
| æ— æ³•å¯åŠ¨ | Javaæ˜¯å¦å®‰è£… | å®‰è£…Javaå¹¶é…ç½®ç¯å¢ƒå˜é‡ |
| å†…å­˜ä¸è¶³ | å†…å­˜åˆ†é…æ˜¯å¦åˆç† | å¢åŠ Xmxå€¼ |
| é¢‘ç¹å¡é¡¿ | TPSæ˜¯å¦ä½äº20 | ä¼˜åŒ–æ’ä»¶ã€å¢åŠ å†…å­˜ã€ä½¿ç”¨æ€§èƒ½åˆ†æå·¥å…· |
| å¯åŠ¨å³å´©æºƒ | æŸ¥çœ‹æ—¥å¿—æ–‡ä»¶ | æ ¹æ®é”™è¯¯ä¿¡æ¯ä¿®å¤ï¼ˆEULAã€ç«¯å£ã€Javaç‰ˆæœ¬ç­‰ï¼‰ |
| æ— æ³•è¿æ¥ | ç«¯å£æ˜¯å¦å¼€æ”¾ | é…ç½®é˜²ç«å¢™ã€æ£€æŸ¥è·¯ç”±å™¨ç«¯å£è½¬å‘ |