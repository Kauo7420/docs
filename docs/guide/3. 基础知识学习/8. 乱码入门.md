---
title: 乱码入门
icon: material-symbols:chat-error-rounded
createTime: 2026/02/05 00:59:39
permalink: /guide/ji-chu-zhi-shi-xue-xi/luan-ma-ru-men/
foo: foo
tags:
    - 信息
    - 日志
---

锟斤拷锟斤拷锟斤拷锟斤拷锟斤拷锟斤拷锟斤拷锟斤拷锟斤拷锟斤拷锟斤拷……

## 什么是乱码？

乱码是指在Minecraft服务器中，原本应该显示为正常中文或其他语言文字的内容，却显示成了==一堆无法识别的符号、问号或方块字符==。

### 举个例子？

**比方说，一条正常的信息会这样显示：**
```
欢迎来到我的服务器！
```

**但是当它变成一串乱码后……**
```
æ¬¢è¿Žæ¥å°æçæå¡å¨ï¼
???????????
□□□□□□□□□□□
```

## 乱码的常见表现

::: steps

1. **问号乱码**

    显示为一连串的问号：`???` 或 `???`

2. **方块乱码**

    显示为空心方块：`□□□□□□□□`

3. **乱码字符**

    显示为看不懂的字符组合：`æ±‰å­—`、`ä¸­æ–‡`

4. **汉字乱码**

    显示为中文汉字但无实际含义的汉字字符：`锟斤拷锟斤拷锟斤拷`

5. **半乱码**

    部分文字正常，部分文字乱码：`欢迎来到???服务器`

:::

## 为什么会产生乱码？

### 核心概念：字符编码

计算机存储文字时，==需要将文字转换为数字代码==，这个过程叫做“编码”。当读取文字时，又需要将数字代码转换回文字，这叫“解码”。

**如果编码和解码使用的“密码本”不一致，就会产生乱码。**

### 常见编码方式

| 编码名称 | 说明 | 适用范围 |
|---------|------|---------|
| UTF-8 | 国际通用编码，推荐使用 | 支持全球所有语言 |
| GBK | 中国国家标准编码 | 主要支持简体中文 |
| GB2312 | 较老的中文编码 | 简体中文（字符较少） |
| ANSI | 系统默认编码 | 根据系统语言变化 |

### 一个简单的示意图

```
写入文件时使用: UTF-8编码  → 文件内容: [E4 B8 AD E6 96 87]
读取文件时使用: GBK编码   → 显示结果: 乱码！

正确方式:
写入文件时使用: UTF-8编码  → 文件内容: [E4 B8 AD E6 96 87]
读取文件时使用: UTF-8编码  → 显示结果: 中文 ✓
```

## 乱码出现的常见场景

::: steps

1. 场景一：服务器控制台乱码

    ::: card title="表现" icon="material-symbols:search-rounded"
    服务器启动后，控制台输出的中文部分全是乱码，或者是插件提示信息显示异常（乱码）
    :::
    ::: card title="原因" icon="mynaui:question"
    可能是因为Java运行参数未指定UTF-8编码；
    
    或是操作系统编码与服务器不匹配，也有可能。例如 Windows10 的默认编码格式就是 GBK ，而 Minecraft 的默认编码格式是 UTF-8 ，二者编码不一，互相转换就会导致乱码的出现。
    :::

2. 场景二：配置文件乱码

    ::: card title="表现" icon="material-symbols:search-rounded"
    `config.yml`等配置文件中的中文部分变成乱码 or 修改保存后中文消失
    :::
    ::: card title="原因" icon="mynaui:question"
    有可能是因为你的编辑器使用了错误的编码保存文件，然后编码不一，转换后导致乱码的出现；

    修改保存后中文消失就应该是因为文件本身编码与读取编码不一致而导致的编码不一。
    :::

3. 场景三：游戏内聊天乱码

    ::: card title="表现" icon="material-symbols:search-rounded"
    进游戏后：看到的玩家聊天消息显示乱码 or 插件消息无法正常显示
    :::
    ::: card title="原因" icon="mynaui:question"
    那这就不是服务器的问题了，这就是你客户端与服务器编码不匹配的问题，而插件消息无法正常显示就有可能是插件配置文件编码错误。
    :::

4. 场景四：MOTD（服务器列表描述）乱码

    ::: card title="表现" icon="material-symbols:search-rounded"
    在服务器列表中看到的服务器描述（MOTD信息）是乱码
    :::
    ::: card title="原因" icon="mynaui:question"
    不用想，就是`server.properties`文件的编码错误导致的乱码，如果是MOTD插件配置的MOTD信息的话，那么问题就出在对应MOTD插件上面。
    :::

:::

## 解决乱码

这里根据**不同的情况**给出了**不同的方案**，你可以根据实际情况灵活进行选择。

### 方案一：设置Java启动参数 <Badge type="tip" text="推荐" />

这是最根本的解决方案，直接在服务器启动脚本中添加UTF-8编码参数。

::: steps

1. Windows系统

    **编辑启动脚本（start.bat）：**

    ```batch
    @echo off
    java -Dfile.encoding=UTF-8 -Xms1G -Xmx4G -jar server.jar nogui
    pause
    ```

    **说明：**
    - `-Dfile.encoding=UTF-8` 是关键参数，指定使用UTF-8编码
    - 将此参数放在 `-jar` 之前

2. Linux系统

    **编辑启动脚本（start.sh）：**

    ```bash
    #!/bin/bash
    java -Dfile.encoding=UTF-8 -Xms1G -Xmx4G -jar server.jar nogui
    ```

    **设置权限：**
    ```bash
    chmod +x start.sh
    ```

:::

### 方案二：配置文件编码修复

这个也不难，只要你的双手和大脑全程参与就行。

:::: card-grid
::: card title="推荐" icon="icon-park-solid:good-two"
- **Notepad++**（Windows）
- **VS Code**（全平台）
- **Sublime Text**（全平台）
:::
::: card title="不推荐" icon="icon-park-solid:bad-two"
- Windows记事本（容易出事）
- WordPad
:::
::::

::: steps

1. **Notepad++设置步骤**

    1. 打开配置文件
    2. 点击顶部菜单 **编码** → **转为UTF-8编码**
    3. 保存文件

    ::: tip 重要提示
    选择"UTF-8"而非"UTF-8 BOM"
    :::

2. **VS Code设置步骤**

    1. 打开配置文件
    2. 查看右下角编码显示
    3. 点击编码名称，选择 **通过编码保存**
    4. 选择 **UTF-8**
    5. 保存文件

:::

### 方案三：批量转换已乱码的文件

如果文件==已经乱码==了的话，就需要先==识别原编码==再转换。

::: warning
以下操作步骤不一定能起作用，对于一些萌新服主而言，已经乱码的文件再进行逆反处理的话会变得比较棘手……
:::

::: steps

1. **使用网站在线工具**

    搜索“UTF-8编码转换工具”，将文本内容：
    1. 粘贴到工具中
    2. 选择原编码（尝试GBK/GB2312）
    3. 转换为UTF-8
    4. 复制回文件并保存
    5. 如果不行就试试其他原编码，直到显示出正常的原信息为止

2. **使用转换软件**

    **Windows推荐：**ConvertZ<br>
    **Linux命令：**
    ```bash
    iconv -f GBK -t UTF-8 old_file.yml > new_file.yml
    ```

:::

### 方案四：修复`server.properties`

**步骤:**

::: steps

1. 停止服务器
2. 用Notepad++或VS Code打开`server.properties`
3. 检查编码是否为UTF-8
4. 修改motd内容
5. 保存为UTF-8编码
6. 重启服务器

:::

**示例配置：**
```properties
motd=§a欢迎来到我的服务器！§r
```

### 方案五：插件配置文件修复

大多数插件的配置文件都在 `plugins/插件名/` 目录下。

**标准流程（以EssentialsX插件为例）：**

::: steps

1. 停止服务器
2. 进入插件配置目录

    ::: file-tree
    
    - plugins
        - Essentials
            - userdata/
            - userdata-npc-backup/
            - warps/
            - **config.yml** ← 插件配置文件在这里！
            - custom_items.yml
            - items.json
            - jail.yml
            - kits.yml
            - motd.txt
            - tpr.yml
            - upgrades-done.yml
            - usermap.bin
            - uuids.bin
            - worth.yml
        - EssentialsX.jar

    :::
3. 用==UTF-8==编辑器打开`config.yml`
4. 如果已乱码：

   那就把配置文件先删掉

    ::: file-tree

    - plugins
        - Essentials
            - userdata/
            - userdata-npc-backup/
            - warps/
            - -- config.yml ← 把我删掉！
            - custom_items.yml
            - items.json
            - jail.yml
            - kits.yml
            - motd.txt
            - tpr.yml
            - upgrades-done.yml
            - usermap.bin
            - uuids.bin
            - worth.yml
        - EssentialsX.jar
    
    :::

   然后重启服务器让插件自动生成新文件，再重新配置一下配置文件即可
5. 如果未乱码：

   那就确保以==UTF-8==编码格式保存文件

6. 启动服务器

:::

### 方案六：系统环境变量设置 <Badge type="tip" text="拓展" />

#### Windows系统

1. 右键 **此电脑** → **属性**
2. **高级系统设置** → **环境变量**
3. 在系统变量中新建：
   - 变量名：`JAVA_TOOL_OPTIONS`
   - 变量值：`-Dfile.encoding=UTF-8`
4. 确定并重启服务器

#### Linux系统

编辑 `.bashrc` 或 `.profile`：
```bash
export JAVA_TOOL_OPTIONS="-Dfile.encoding=UTF-8"
export LC_ALL=zh_CN.UTF-8
export LANG=zh_CN.UTF-8
```

执行：
```bash
source ~/.bashrc
```

---

## 预防乱码

### 1. 统一编码

预防乱码的最好办法就是一直保持**统一编码**的状态，**这样做可以免去90%关于乱码的疑难杂症！**记住一个黄金法则：==**所有**文件、配置、脚本都使用**UTF-8编码**，**永不例外**=={.important}。

当然，你可以通过配置启动脚本来实践这个“黄金法则”，**创建一个标准启动脚本并保存：**

（Windows版本）
```batch title="start.bat"
@echo off
title Minecraft Server
java -Dfile.encoding=UTF-8 -Duser.language=zh -Duser.country=CN -Xms2G -Xmx4G -jar server.jar nogui
pause
```

（Linux版本）
```bash title="start.sh"
#!/bin/bash
java -Dfile.encoding=UTF-8 -Duser.language=zh -Duser.country=CN -Xms2G -Xmx4G -jar server.jar nogui
```

### 2. 编辑器默认编码设置

哦对了，还得记得去**设置编辑器的默认编码**：

::: steps

1. VS Code设置

    按下`Ctrl`+`,`键打开设置，然后在设置中搜索“encoding”，设置:
    ```json
    {
        "files.encoding": "utf8",
        "files.autoGuessEncoding": false
    }
    ```

2. Notepad++设置

    **设置** → **首选项** → **新建** → **编码**：选择UTF-8

:::

### 3. 还有……

这些东西肯定是不够的，你还得记住这两个习惯：

:::: card-grid
::: card title="定期检查" icon="material-symbols:check-box-outline-rounded"
每次添加新插件或修改配置后，启动服务器检查是否有乱码。
:::
::: card title="经常备份" icon="wordpress:backup"
修改重要配置前，先备份原文件。如果出现乱码，可以立即恢复。
:::
::::

## 常见问题解答（FAQ）

### Q1：为什么我的启动脚本加了UTF-8参数还是乱码？

**可能原因：**

1. 参数位置错误（必须在`-jar`之前）
2. 配置文件本身已经是乱码状态，需要重新生成
3. 使用了不支持UTF-8的终端程序

**解决方法：**

检查参数顺序，删除乱码配置文件重新生成。

### Q2：Linux服务器中文全是问号怎么办？

**原因：**系统缺少中文字体或语言包。

**解决方法：**

```bash
# Ubuntu/Debian
sudo apt-get install language-pack-zh-hans
sudo apt-get install fonts-wqy-zenhei

# CentOS
sudo yum install fontconfig
sudo yum groupinstall "fonts"
```

### Q3：用记事本改了配置文件就乱码了？

**原因：**Windows记事本可能添加BOM标记或使用错误编码。

**解决方法：**

永远不要用Windows自带记事本编辑配置文件，改用Notepad++或VS Code。

### Q4：插件生成的文件总是GBK编码怎么办？

**原因：**某些老旧插件强制使用系统默认编码。

**解决方法：**

1. 联系插件作者更新
2. 使用替代插件
3. 启动参数设置默认编码（[方案一](#方案一-设置java启动参数)）

### Q5：客户端看到的聊天是乱码，但服务器正常？

**原因：**客户端资源包或MOD编码问题。

**解决方法：**

1. 检查客户端是否使用了错误编码的资源包
2. 更新或移除有问题的MOD
3. 重新安装客户端

### Q6：YAML配置文件报错“mapping values are not allowed here”

**原因：**这通常不是编码问题，而是YAML语法错误。

**检查项：**

- 冒号后面必须有空格：`key: value`（不是`key:value`）
- 缩进必须使用空格，不能用Tab
- 中文引号要改成英文引号

**工具：**使用在线YAML验证器检查语法

### Q7：面板服如何解决乱码？

**步骤：**

1. 进入面板的文件管理
2. 编辑启动命令，添加 `-Dfile.encoding=UTF-8`
3. 使用面板自带编辑器时，查看是否有编码选项
4. 如果面板不支持，使用FTP下载文件到本地修改后上传

### Q8：怎么判断文件当前是什么编码？

**方法一：**使用Notepad++

打开文件，查看右下角显示的编码类型

**方法二：**使用VS Code

打开文件，右下角显示当前编码

**方法三：**Linux命令

```bash
file -i filename.yml
```

### Q9：UTF-8和UTF-8 BOM有什么区别？

**UTF-8：**纯UTF-8编码，推荐使用

**UTF-8 BOM：**在文件开头添加特殊标记(BOM)，某些程序可能无法识别

**建议：**Minecraft配置文件请使用UTF-8(无BOM)

### Q10：服务器迁移后全部乱码怎么办？

**原因：**新旧服务器系统编码不一致

**解决步骤：**

1. 在新服务器上设置UTF-8启动参数
2. 检查所有配置文件编码
3. 必要时重新生成配置文件
4. 逐个插件测试修复

## 快速诊断流程图

```
遇到乱码
    ↓
是否是服务器控制台乱码？
    ├─ 是 → 检查启动脚本是否有 -Dfile.encoding=UTF-8
    └─ 否 → 继续
         ↓
是否是配置文件乱码？
    ├─ 是 → 用UTF-8编辑器重新保存
    └─ 否 → 继续
         ↓
是否是游戏内聊天乱码？
    ├─ 是 → 检查插件配置文件编码
    └─ 否 → 检查客户端资源包
```

---

## 重点总结

### 牢记三大核心要点！！！<Badge type="important" text="重要" />

1. **所有文本文件必须使用UTF-8编码**
2. **启动脚本必须添加 `-Dfile.encoding=UTF-8` 参数**
3. **使用专业编辑器(Notepad++/VS Code)，不用系统记事本**

### 黄金公式

```
UTF-8编码配置文件 + UTF-8启动参数 + UTF-8编辑器 = 永不乱码
```

## 最后的建议

遇到乱码问题==不要慌张==，按照本指南的步骤一步步排查。==大多数乱码问题都可以通过统一使用UTF-8编码来解决==。

**记住：**预防胜于治疗，在开服之初就做好编码规范，**可以避免99%的乱码问题**。

还是那句话，祝你开服顺利！🎮

## 附录：工具下载链接

- **Notepad++**：[https://notepad-plus-plus.org/](https://notepad-plus-plus.org/)
- **VS Code**：[https://code.visualstudio.com/](https://code.visualstudio.com/)
- **ConvertZ** (编码转换)：搜索引擎搜索“ConvertZ下载”